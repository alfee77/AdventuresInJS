<!DOCTYPE html>

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="../root-css/styles.css">
    </head>
    
    <body>
        <div class = "header" id="header"></div>
        <div class="topnav" id="topnav"></div>
        <div class="row">
            <div class="column side" id="column side left"></div>
            <div class="column middle">
                <h2>Arrays</h2>
                <p>Objects allow you to store keyed collections of values; this is fine and dandy, but sometimes we need to store things
                    in an ordered fashion. Objects dont provide methods for ordering such an ordered collection. Arrays are a special data structure
                    that is used to store these sorts of collections.
                </p>
                <h3>Declaration</h3>
                <p>JavaScript provides two syntaxes for creating empty arrays:</p>
                <div class="codeLines">
let arr = new Array();
let arr = [];
                </div>
                <p>Almost all of the time the second syntax is used. The array can be initialised with stuff in the brackets:</p>
                <div class="codeLines">
let vegetables = ["Potato", "Tomato", "Pepper"];
                </div>
                <p>Array elements are numbered, starting at 0. We can access an element by putting it's number in the square brackets:</p>
                <div class="codeLines">
let vegetables = ["Potato", "Tomato", "Pepper"];

alert(vegetables[0]); <span class="comment">//Potato</span>
alert(vegetables[1]); <span class="comment">//Tomato</span>
alert(vegetables[2]); <span class="comment">//Pepper</span>
                </div>
                <p>We can replace an element:</p>
                <div class="codeLines">
vegetables[2] = Carrot <span class="comment">//now ["Potato, "Tomato", "Carrot"]</span>
                </div>
                <p>...Or add a new one to the array:</p>
            <div class="codeLines">
vegetables[3] = "Mushrooms"; <span class="comment">//now ["Potato, "Tomato", "Carrot", "Mushrooms"] </span>
                </div>
                <p>The total count of the array is its <code>length</code>:</p>
                <div class="codeLines">
let vegetables = ["Potato", "Tomato", "Pepper"];

alert(vegetables.length); <span class="comment">//3</span>
                </div>
                <p>We can also use <code>alert</code> to show the whole array:</p>
        
                <div class="codeLines">
let vegetables = ["Potato", "Tomato", "Pepper"];

alert(vegetables); <span class="comment">//Potato, Tomato, Pepper</span>
                </div>

                <p>An array can store elements of any type. For instance:</p>

                <div class="codeLines">
<span class="comment">//mix of values</span>
let arr = ["Potato", { name: "Alistair"}, true, function() { alert("Hello!")}];

<span class="comment">//get the object at index 1, and then alert the value associated with the "name" key:</span>
alert(arr[1].name);

<span class="comment">//get the function at index 3 and run it:</span>
arr[3]();

<button onclick="example1()">Run</button>
                </div>
                <div class="info">
                    <p>ℹ️<strong> Trailing comma</p></strong>
                    <p>In JavaScript, an array, just like an object, may end with a trailing comma:</p>
                    <div class="codeLines">
let vegetables = [
    "Potato",
    "Tomato",
    "Pepper",
];
                    </div>
                </div>
                <h3>Get last elements with "at"</h3>
                <div class="info">
                    <p>⚠️<strong> A recent addition to JavaScript</p></strong>
                    <p>This is a recent addition to the language. Old browsers may need polyfills.</p>
                </div>
                <p>Let’s say we want the last element of the array.</p>

                <p>Some programming languages allow the use of negative indexes for the same purpose, like vegetables[-1].</p>

                <p>Although, in JavaScript it won’t work. The result will be undefined, because the 
                    index in square brackets is treated literally.</p>

                <p>We can explicitly calculate the last element index and then access it: <code>vegetables[vegetables.length - 1]</code>.</p>

                <div class="codeLines">
let vegetables = ["Potato", "Tomato", "Pepper"];

alert( vegetables[vegetables.length-1] ); <span class="comment">// Plum</span>
                </div>
<p>Perhaps this is a bit cumbersome (although I'm not sure I agree)? There’s a shorter
    syntax: vegetables.at(-1):</p>

<div class="codeLines">
let vegetables = ["Potato", "Tomato", "Pepper"];

<span class="comment">// same as vegetables[vegetables.length-1]</span>
alert( vegetables.at(-1) ); // Pepper
</div>
                <p>In other words, <code>arr.at(i)</code>:</p>
                <ul>
                    <li>is exactly the same as arr[i], if i >= 0.</li>
                    <li>for negative values of i, it steps back from the end of the array.</li>
                </ul>
            
                <h3>Stacks and queues</h3>
                <p>Arrays can be used to facilitate stacks and queues. JavaScript provides methods to support using arrays 
                in these data structures, including <code>pop()</code>, <code>push()</code>, <code>shift()</code> 
                and <code>unshift()</code>. The <code>push()</code> and <code>pop()</code> methods are explained below, 
                in the context of a stack, followed by the <code>shift()</code>, <code>de-shift()</code> and <code>pop()</code> 
                methods in the context of a queue.</p>

                <h4>Stack</h4>
                <p>In computing science, a stack is something that has elements added to the top of it via the <code>push()</code> 
                method, and then taken off the top via the <code>pop()</code> method. Think of a stack as data structure with a first-in
                first-out rule set. Calling <code>vegetables.push("Carrot")</code> will push a Carrot onto the top of the stack
                depicted by the <code>vegetables[]</code> array:</p>
                <figure>
                    <img src="images/stack-push.png" alt="">
                    <figcaption>Calling <code> vegetables.push("Carrot")</code> method on a stack</figcaption>
                </figure>
                <p>Calling the <code>vegetables.pop()</code> method will pop whatever is on top of the array off (in this case 
                "Carrot"):</p>
                <figure>
                    <img src="images/stack-pop.png" alt="">
                    <figcaption>Calling <code> vegetables.pop()</code> method on a stack</figcaption>
                </figure>
                <h4>Queue</h4>
                <p>A queue is something that adds an element to the end of the
                queue via the <code>push()</code> method, and bumps off the element at the front of the queue via the
                <code>shift()</code> method. (note the <code>deshift()</code> method allows you to put it, or something 
                else, back on) Think of a queue as a left-to-right entity, following a first-in last-out rule set. Calling 
                <code>vegetables.push("Carrot")</code> will add a carrot to the back of the queue:</p>
                <figure>
                    <img src="images/queue-push.png" alt="">
                    <figcaption>Calling <code> vegetables.push("Carrot")</code> method on a queue</figcaption>
                </figure>
                <p>Calling <code>vegetables.shift()</code> will take whatever is at the front of the queue off, and shift the remaining items
                up one place in the queue:</p>
                <figure>
                    <img src="images/queue-shift.png" alt="">
                    <figcaption>Calling <code> vegetables.shift()</code> method on a queue</figcaption>
                </figure>
                <p>Note how calling <code>push()</code> causes the rest of the array elements to shift address by one. This is 
                an important consideration when it comes to performance. Pushing/popping doesn't require re-ordering all the items
                in the array. Shifting and deshifting does!</p>


                
                <h3>Internals</h3>

                <p>An array is a special kind of object. The square brackets used to access a property arr[0] actually come from
                the object syntax. That’s essentially the same as obj[key], where arr is the object, while numbers are used as keys.</p>
                
                <p>They extend objects providing special methods to work with ordered collections of data and also the length property. 
                But at the core it’s still an object.</p>
                
                <p>Remember, there are only eight basic data types in JavaScript (see the Data types chapter for more info). Array is 
                an object and thus behaves like an object.</p>
                
                <p>For instance, it is copied by reference:</p>
                
                <div class="codeLines">
let fruits = ["Banana"]

let arr = fruits; <span class="comment">// copy by reference (two variables reference the same array)</span>

alert( arr === fruits ); <span class="comment">// true</span>

arr.push("Pear"); <span class="comment">// modify the array by reference</span>

alert( fruits ); <span class="comment">// Banana, Pear - 2 items now</span>
                </div>
                <p>…But what makes arrays really special is their internal representation. The engine tries to store its elements 
                in the contiguous memory area, one after another, just as depicted on the illustrations in this chapter, and there
                are other optimizations as well, to make arrays work really fast.</p>
                
                <p>But they all break if we quit working with an array as with an “ordered collection” and start working with it as 
                if it were a regular object.</p>
                
                <p>For instance, technically we can do this:</p>
                
                <div class="codeLines">
let fruits = []; <span class="comment">// make an array</span>

fruits[99999] = 5; <span class="comment">// assign a property with the index far greater than its length</span>

fruits.age = 25; <span class="comment">// create a property with an arbitrary name</span>
                </div>
                <p>That’s possible, because arrays are objects at their base. We can add any properties to them.<em>However</em> the engine
                will see that we’re working with the array as with a regular object. Array-specific optimizations are not suited for 
                such cases and will be turned off, their benefits disappear.</p>
                
                <p>The ways to misuse an array:</p>
                
                <ul>
                    <li>Add a non-numeric property like <code>arr.test = 5</code>.</li>
                    <li>Make holes, like: add <code>arr[0]</code> and then <code>arr[1000] </code>(and nothing between them).</li>
                    <li>Fill the array in the reverse order, like <code>arr[1000]</code>, <code>arr[999]</code> and so on.</li>
                </ul>
                <p>You MUST think of arrays as special structures to work with the <em>ordered data</em>. They provide special methods 
                for that. Arrays are carefully tuned inside JavaScript engines to work with contiguous ordered data, please use 
                them this way. And if you need arbitrary keys, chances are high that you actually require a regular object {}.</p>

                <h3>Performance</h3>
                <p><code>push()/pop()</code> are rapid. <code>shift()/unshift()</code> do not. Think about it: <code>push()/pop()</code> 
                lift something from the "top" of the array; the remaining elements remain in their indexed place. <code>shift()/unshift()</code> 
                <em>do not</em>.
                <figure>
                    <img src="images/performance.png" alt="">
                    <figcaption>Array performance</figcaption>
                </figure>
                <p>Shifting an element off the "front" of the array causes the others to bump along (contents of array element [1] moves to [0] and 
                so on). Additionally, the <code>length</code> property needs recalculated and updated.</p>
                <h3>Loops</h3>
                <p>One of the oldest ways to cycle array items is the for loop over indexes:</p>

                <div class="codeLines">
let arr = ["Apple", "Orange", "Pear"];

for (let i = 0; i < arr.length; i++) {
    alert( arr[i] );
}
                </div>
                <p>But for arrays there is another form of loop, <code>for...of</code>:</p>

                <div class="codeLines">
let fruits = ["Apple", "Orange", "Plum"];

<span class="comment">// iterates over array elements</span>
for (let fruit of fruits) {
  alert( fruit );
}
                </div>
                <p>The <code>for..of</code> doesn’t give access to the number of the current element, just its value, but in most cases that’s enough. And it’s shorter.</p>

                <p>Technically, because arrays are objects, it is also possible to use <code>for..in</code>:</p>

                <div class="codeLines">
let arr = ["Apple", "Orange", "Pear"];

for (let key in arr) {
    alert( arr[key] ); <span class="comment">// Apple, Orange, Pear</span>
}
                </div>
                <p>But that’s actually a bad idea. There are potential problems with it:</p>

                <p>The loop <code>for...in</code> iterates over all properties, not only the numeric ones.</p>

                <p>There are so-called “array-like” objects in the browser and in other environments, that look like arrays. That is, they have length and indexes properties, 
                but they may also have other non-numeric properties and methods, which we usually don’t need. The for..in loop will list them though. So if we need to work 
                with array-like objects, then these “extra” properties can become a problem.</p>

                <p>The <code>for...in</code> loop is optimized for generic objects, not arrays, and thus is 10-100 times slower. Of course, it’s still very fast. The speedup may
                only matter in bottlenecks. But still we should be aware of the difference.</p>

                <p>Generally, we shouldn’t use <code>for..in</code> for arrays.</p>

                <h3>A word about length</h3>
                <p>The length property automatically updates when we modify the array. To be precise, it is actually not the count of 
                values in the array, but the greatest numeric index plus one.</p>

                <p>For instance, a single element with a large index gives a big length:</p>
                <div class="codeLines">

let fruits = [];
fruits[123] = "Apple";

alert( fruits.length ); <span class="comment">// 124</span>
                </div>
                <p>Note that we usually don’t use arrays like that.</p>

                <p>Another interesting thing about the length property is that it’s writable.</p>

                <p>If we increase it manually, nothing interesting happens. But if we decrease it, the array is truncated. The process 
                is irreversible, here’s the example:</p>

                <div class="codeLines">
let arr = [1, 2, 3, 4, 5];

arr.length = 2; <span class="comment">// truncate to 2 elements</span>
alert( arr ); <span class="comment">// [1, 2]</span>

arr.length = 5; <span class="comment">// return length back</span>
alert( arr[3] );<span class="comment"> // undefined: the values do not return</span>
                </div>
                <p>So, the simplest way to clear the array is: <code>arr.length = 0</code>;.</p>

                <h3>new Array()</h3>
                <p>There is one more syntax to create an array:</p>

                <div class="codeLines">
let arr = new Array("Apple", "Pear", "etc");
                </div>
                <p>It’s rarely used, because square brackets [] are shorter. Also, there’s a tricky feature with it.</p>

                <p>If new Array is called with a single argument which is a number, then it creates an array without items, but with the given length.</p>

                <p>Let’s see how one can shoot themselves in the foot:</p>

                <div class="codeLines">
let arr = new Array(2); <span class="comment">// will it create an array of [2] ?</span>

alert( arr[0] ); <span class="comment">// undefined! no elements.</span>

alert( arr.length ); <span class="comment">// length 2</span>
                </div>
                <p>To avoid such surprises, we usually use square brackets, unless we really know what we’re doing.</p>
                <h3>Multidimensional arrays</h3>
                <p>Arrays can have items that are also arrays. We can use it for multidimensional arrays, for example to store matrices:</p>
                <div class="codeLines">
let matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
];

alert( matrix[0][1] ); <span class="comment">// 2, the second value of the first inner array</span>
                </div>
                <h3>toString</h3>
                <p>Arrays have their own implementation of <code>toString()</code> method that returns a comma-separated list of elements.</p>

                <p>For instance:</p>
                <div class="codeLines">
let arr = [1, 2, 3];

alert( arr ); <span class="comment">// 1,2,3</span>
alert( String(arr) === '1,2,3' ); <span class="comment">// true</span>
                </div>
                <p>Also, let’s try this:</p>
                <div class="codeLines">
alert( [] + 1 ); <span class="comment">// "1"</span>
alert( [1] + 1 ); <span class="comment">// "11"</span>
alert( [1,2] + 1 ); <span class="comment">// "1,21"</span>
                </div>
                <p>Arrays do not have <code>Symbol.toPrimitive</code>, neither a viable <code>valueOf</code>, they implement only toString conversion, so 
                here [] becomes an empty string, [1] becomes "1" and [1,2] becomes "1,2".</p>

                <p>When the binary plus "+" operator adds something to a string, it converts it to a string as well, so the 
                next step looks like this:</p>
                <div class="codeLines">
alert( "" + 1 ); <span class="comment">// "1"</span>
alert( "1" + 1 ); <span class="comment">// "11"</span>
alert( "1,2" + 1 ); <span class="comment">// "1,21"</span>
                </div>

                <h3>Don't compare arrays with ==</h3>

                <h3>Summary</h3>
                <p>Array is a special kind of object, suited to storing and managing ordered data items.</p>

                <p>The declaration:</p>
                <div class="codeLines">
<span class="comment">// square brackets (usual)</span>
let arr = [item1, item2...];

<span class="comment">// new Array (exceptionally rare)</span>
let arr = new Array(item1, item2...);
                </div>
                <p>The call to new Array(number) creates an array with the given length, but without elements.</p>

                <ul>
                    <li>The length property is the array length or, to be precise, its last numeric index plus one. It is auto-adjusted by array methods.</li>
                    <li>If we shorten length manually, the array is truncated.</li>
                </ul>
                <p>Getting the elements:</p>
                <ul>
                    <li>we can get element by its index, like arr[0]</li>
                    <li>also we can use at(i) method that allows negative indexes. For negative values of i, it steps back from the end of the array. 
                    If i >= 0, it works same as arr[i].</li>
                </ul>

                <p>We can use an array as a deque with the following operations:</p>

                <ul>
                    <li><code>push(...items)</code> adds items to the end.</li>
                    <li><code>pop()</code> removes the element from the end and returns it.</li>
                    <li><code>shift()</code> removes the element from the beginning and returns it.</li>
                    <li><code>unshift(...items)</code> adds items to the beginning.</li>
                </ul>

                <p>To loop over the elements of the array:</p>

                <ul>
                    <li><code>for (let i=0; i<arr.length; i++)</code> – works fastest, old-browser-compatible.</li>
                    <li><code>for (let item of arr)</code> – the modern syntax for items only,</li>
                    <li><code>for (let i in arr)</code> – never use.</li>
                </ul>
            <p>To compare arrays, don’t use the == operator (as well as >, < and others), as they have no special treatment for arrays. They handle 
            them as any objects, and it’s not what we usually want.</p>

            <p>Instead you can use for..of loop to compare arrays item-by-item.</p>

            <p>We will continue with arrays and study more methods to add, remove, extract elements and sort arrays in the next chapter Array methods.</p>
            
            <h3>Tasks</h3>
                <div class="task">
                    <h4>Task 1 - Is array copied?</h4>
                    <p>importance: 3</p>
                    <p>What is this code going to show?</p>
                    <div class="codeLines">
let fruits = ["Apples", "Pear", "Orange"];

<span class="comment">// push a new value into the "copy"</span>
let shoppingCart = fruits;
shoppingCart.push("Banana");

<span class="comment">// what's in fruits?</span>
alert( fruits.length ); <span class="comment">// ?</span>

<button onclick="task1()">Run</button>
                    </div>
                </div>
                <div class="task">
                    
                    <h4>Task 2 - Is array copied?</h4>
                    <p>importance: 5</p>
                    <p>Let’s try 5 array operations.</p>

                    <ol>
                        <li>Create an array styles with items “Jazz” and “Blues”.</li>
                        <li>Append “Rock-n-Roll” to the end.</li>
                        <li>Replace the value in the middle with “Classics”. Your code for finding the middle value should work for any arrays with odd length.</li>
                        <li>Strip off the first value of the array and show it.</li>
                        <li>Prepend Rap and Reggae to the array.</li>
                    </ol>
                    <p>The array in the process:</p>
                    <div class="codeLines">
Jazz, Blues
Jazz, Blues, Rock-n-Roll
Jazz, Classics, Rock-n-Roll
Classics, Rock-n-Roll
Rap, Reggae, Classics, Rock-n-Roll
                    </div>
                    <div class="task-solution">
                        <h4>Solution</h4>
                        <div class="output">
                            <button onclick="task2()">Run</button>
                        </div>
                        
                    </div>
                </div>
                <div class="task">
                    <h4>Task 3 - Sum input numbers</h4>                    
                    <p>importance: 4</p>
                    <p>Write the function <code>sumInput()</code> that:</p>

                    <ul>
                        <li>Asks the user for values using prompt and stores the values in the array.</li>
                        <li>Finishes asking when the user enters a non-numeric value, an empty string, or presses “Cancel”.</li>
                        <li>Calculates and returns the sum of array items.</li>
                    </ul>

                    <p>P.S. A zero 0 is a valid number, please don’t stop the input on zero.</p>
                    <div class="task-solution">
                        <h4>Solution</h4>
                        <div class="codeLines">
function task3(){
    arr=[];

    function sumInput(){
        let input = +prompt(`Enter numbers one at a time: `, `0-10`);
        let runTot=0;
        while (!isNaN(input) && input){
            arr.push(input);
            input = 0;
            input = +prompt("Next number: ", `0-10 (remember non-numeric entry to stop!)`);
        }
        for(let i of arr){
            runTot += i;
        }
        return runTot;
    }

    
    console.log(arr);
    console.log(sumInput());
}
                        </div>
                        
                        <div class="output">
                            <button onclick="task3()">Run</button>
                        </div>
                        
                    </div>
                </div>
            </div>
            
            <div class="column side" id="column side right"></div>
            
        </div>

        <div class="footer" id="footer"></div>

    

    </body>

    <script src="../root-js/JavaScriptInfoMenu.js"></script>
    <script src="js/4-arrays.js"></script>
    

</html>